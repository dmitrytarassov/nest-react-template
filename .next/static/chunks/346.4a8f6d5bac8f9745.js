(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{35346:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return $}});var r=t(52322),o=t(2784),i=t(25237),c=t(58694),u=(t(79075),t(11035));function a(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function s(n){return function(n){if(Array.isArray(n))return a(n)}(n)||function(n){if("undefined"!==typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(!n)return;if("string"===typeof n)return a(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return a(n,e)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var f=function(n){var e=n.map,t=n.coordinates,r=n.active,i=n.icon,c=n.onClick,u=(0,o.useState)(),a=u[0],f=u[1];return(0,o.useEffect)((function(){var n=r?80:40,o=new window.ymaps.Placemark(t,{},{iconLayout:"default#imageWithContent",iconImageHref:i,iconImageSize:[n,n],iconImageOffset:[-n/2,-n/2]});return o.events.add("click",c),e.geoObjects.add(o),setTimeout((function(){s(document.querySelectorAll(".ymaps-2-1-79-image-with-content")).forEach((function(n){(function(n,e){var t,r=(n.ownerDocument||document).defaultView;return r&&r.getComputedStyle?(e=e.replace(/([A-Z])/g,"-$1").toLowerCase(),r.getComputedStyle(n,null).getPropertyValue(e)):n.currentStyle?(e=e.replace(/\-(\w)/g,(function(n,e){return e.toUpperCase()})),t=n.currentStyle[e],/^\d+(em|pt|%|ex)?$/i.test(t)?function(e){var t=n.style.left,r=n.runtimeStyle.left;return n.runtimeStyle.left=n.currentStyle.left,n.style.left=e||0,e=n.style.pixelLeft+"px",n.style.left=t,n.runtimeStyle.left=r,e}(t):t):void 0})(n,"backgroundImage").includes(i)&&f(n)}))}),100),function(){e.geoObjects.remove(o)}}),[t]),(0,o.useEffect)((function(){a&&setTimeout((function(){if(a.classList.add("rental_icon"),r){var n=a.parentNode.parentNode;n.classList.contains("ymaps-2-1-79-placemark-overlay")&&(s(document.querySelectorAll(".ymaps-2-1-79-placemark-overlay")).forEach((function(n){n.classList.remove("active")})),n.classList.add("active")),s(document.querySelectorAll(".ymaps-2-1-79-image-with-content")).forEach((function(n){n.classList.remove("active")})),a.classList.add("active")}}),300)}),[a,r]),null},l=t(46497),d=function(n){var e=n.map,t=(0,l.S)(),i=t.markers,c=t.center,a=t.zoom,s=t.selectRental;return(0,o.useEffect)((function(){c&&e.setCenter(c)}),[c]),(0,o.useEffect)((function(){e.setZoom(a)}),[a]),window._map||(window._map=e),(0,r.jsx)(r.Fragment,{children:i.map((function(n){return(0,r.jsx)(f,{coordinates:n.coordinates,icon:(0,u.Z)(n.icon),map:e,active:n.active,rentalId:n.rentalId,onClick:function(){return s(n.rentalId)}},n.rentalId)}))})},m=t(94776),p=t.n(m);function v(n,e,t,r,o,i,c){try{var u=n[i](c),a=u.value}catch(s){return void t(s)}u.done?e(a):Promise.resolve(a).then(r,o)}function h(n){return function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function c(n){v(i,r,o,c,u,"next",n)}function u(n){v(i,r,o,c,u,"throw",n)}c(void 0)}))}}var g={enableHighAccuracy:!0,timeout:5e3,maximumAge:0};function y(){return w.apply(this,arguments)}function w(){return(w=h(p().mark((function n(){return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,e){navigator.geolocation.getCurrentPosition((function(e){var t=e.coords;n([t.latitude,t.longitude])}),e,g)})));case 1:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var b=t(58975);function x(){var n=(0,o.useContext)(b.s);if(!n)throw new Error("Missing current location context");return n}function k(n,e,t,r,o,i,c){try{var u=n[i](c),a=u.value}catch(s){return void t(s)}u.done?e(a):Promise.resolve(a).then(r,o)}function S(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function j(){var n=S(["\n        background-color: ",";\n      "]);return j=function(){return n},n}function C(){var n=S(["\n      ","\n    "]);return C=function(){return n},n}function I(){var n=S(["\n      bottom: 32px;\n      right: 16px;\n    "]);return I=function(){return n},n}function P(){var n=S(["\n  z-index: 10;\n  position: absolute;\n  background-image: url('/public/get_location.svg');\n  width: 64px;\n  height: 64px;\n  background-color: ",";\n  bottom: 48px;\n  right: 48px;\n  background-position: center;\n  background-repeat: no-repeat;\n  border-radius: 50%;\n  cursor: pointer;\n\n  :hover {\n    ","\n  }\n\n  ","\n"]);return P=function(){return n},n}var E=c.ZP.div.withConfig({componentId:"sc-6a08792d-0"})(P(),(function(n){var e=n.disabled,t=n.theme;return e?t.colors.buttons.disabled.background:t.colors.buttons.default.background}),(function(n){var e=n.disabled;return(0,c.iv)(C(),!e&&(0,c.iv)(j(),(function(n){return n.theme.colors.buttons.hover.background})))}),(function(n){return n.theme.mixins.tablet((0,c.iv)(I()))})),O=function(n){n=null!==n?n:function(n){throw n}(new TypeError("Cannot destructure undefined"));var e=x().setCoordinates,t=(0,o.useState)(!1),i=t[0],c=t[1],u=function(){var n,t=(n=p().mark((function n(){var t;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,c(!0),n.next=4,y();case 4:t=n.sent,e(t),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0);case 11:c(!1);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})),function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function c(n){k(i,r,o,c,u,"next",n)}function u(n){k(i,r,o,c,u,"throw",n)}c(void 0)}))});return function(){return t.apply(this,arguments)}}();return(0,r.jsx)(E,{disabled:i,onClick:u})},A=t(14986),z=function(n){var e=n.map,t=n.position;return(0,o.useEffect)((function(){var n=new window.ymaps.Placemark(t,{},{iconLayout:"default#imageWithContent",iconImageHref:"/public/your_position.svg",iconImageSize:[134,134],iconImageOffset:[-67,-67]});return e.setCenter(t,12),e.geoObjects.add(n),function(){e.geoObjects.remove(n)}}),[t]),null};function L(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function _(){var n=L(["\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: calc(70vh + 72px);\n    "]);return _=function(){return n},n}function Z(){var n=L(["\n  width: 100%;\n  height: 100%;\n  position: relative;\n\n  ","\n\n  .leaflet-container {\n    width: 100%;\n    height: 100%;\n    z-index: 1;\n  }\n"]);return Z=function(){return n},n}function T(){var n=L(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n"]);return T=function(){return n},n}var N=c.ZP.div.withConfig({componentId:"sc-2c1a099e-0"})(Z(),(function(n){return n.theme.mixins.tablet((0,c.iv)(_()))})),q=c.ZP.div.withConfig({componentId:"sc-2c1a099e-1"})(T()),H={moscow:[55.751684,37.618611],spb:[59.93863,30.31413]},M=function(){var n=x().coordinates,e=(0,o.useState)(),t=e[0],i=e[1],c=(0,o.useState)(),u=c[0],a=c[1],s=(0,A.h)().city,f=function(){var n=new window.ymaps.Map("map",{center:H[s],zoom:12,controls:[]});i(n),setTimeout((function(){a(!0)}),100)};return(0,o.useEffect)((function(){window.ymaps.ready(f)}),[]),(0,r.jsxs)(N,{children:[(0,r.jsx)(q,{id:"map"}),t&&n&&(0,r.jsx)(z,{position:n,map:t}),t&&u&&(0,r.jsx)(d,{map:t}),(0,r.jsx)(O,{})]})},$=(0,i.default)((function(){return Promise.resolve(M)}),{ssr:!1})},79075:function(){}}]);